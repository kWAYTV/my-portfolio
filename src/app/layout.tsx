import './globals.css';

import localFont from 'next/font/local';
import Script from 'next/script';
import { ViewTransitions } from 'next-view-transitions';

import { baseUrl } from '@/app/sitemap';
import Footer from '@/components/core/layout/footer';
import { Navbar } from '@/components/core/layout/nav';
import { Providers } from '@/components/core/providers/providers';
import { env } from '@/env';
import { createMetadata } from '@/lib/metadata';

const geistSans = localFont({
  src: './fonts/GeistVF.woff',
  variable: '--font-geist-sans',
  weight: '100 900'
});
const geistMono = localFont({
  src: './fonts/GeistMonoVF.woff',
  variable: '--font-geist-mono',
  weight: '100 900'
});

export default function RootLayout({
  children
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <ViewTransitions>
      <html lang='en' suppressHydrationWarning>
        {env.NEXT_PUBLIC_ENABLE_UMAMI === 'true' && (
          <Script
            defer
            src='https://metrics.kway.club/script.js'
            data-website-id={env.UMAMI_WEBSITE_ID}
            strategy='afterInteractive'
          />
        )}
        <body
          className={`${geistSans.variable} ${geistMono.variable} mx-4 mt-8 max-w-xl antialiased lg:mx-auto`}
        >
          <Providers>
            <main className='mt-6 flex min-w-0 flex-auto flex-col px-2 md:px-0'>
              <Navbar />
              {children}
              <Footer />
            </main>
          </Providers>
        </body>
      </html>
    </ViewTransitions>
  );
}

export const metadata = createMetadata({
  title: {
    default: 'perc.dev',
    template: '%s | perc.dev'
  },
  description: 'Welcome to my portfolio!',
  metadataBase: new URL(baseUrl)
});
